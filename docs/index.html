<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Data Visualization in R with ggplot2</title>
    <meta charset="utf-8" />
    <meta name="author" content="Josh Quan" />
    <script src="libs/header-attrs/header-attrs.js"></script>
    <script src="libs/htmlwidgets/htmlwidgets.js"></script>
    <script src="libs/plotly-binding/plotly.js"></script>
    <script src="libs/typedarray/typedarray.min.js"></script>
    <script src="libs/jquery/jquery.min.js"></script>
    <link href="libs/crosstalk/css/crosstalk.css" rel="stylesheet" />
    <script src="libs/crosstalk/js/crosstalk.min.js"></script>
    <link href="libs/plotly-htmlwidgets-css/plotly-htmlwidgets.css" rel="stylesheet" />
    <script src="libs/plotly-main/plotly-latest.min.js"></script>
    <link rel="stylesheet" href="xaringan-themer.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Data Visualization in R with ggplot2
## Stanford University Libraries
### Josh Quan
### 23 February 2021 <br><br> cidr.link/ggplot2

---






class: center, middle

# Data visualization
---

## Data visualization

&gt; *"The simple graph has brought more information to the data analyst’s mind than any other device."  
&gt; — John Tukey*

- Data visualization is the creation and study of the visual representation of data.
- Many tools for visualizing data (R is one of them)
- Many approaches/systems within R for making data visualizations, **ggplot2** is one of them


---

## Data visualization

![](https://d2f99xq7vri1nk.cloudfront.net/Anscombe_1_0_0.png)

---

## Data visualization

![](https://d2f99xq7vri1nk.cloudfront.net/CloudToCircle.gif)

---

## Data visualization

![](https://d2f99xq7vri1nk.cloudfront.net/DinoSequentialSmaller.gif)
  
---

## ggplot2 `\(\in\)` tidyverse

.pull-left[
&lt;img src="./img/ggplot2-part-of-tidyverse.png" width="80%" /&gt;
]
.pull-right[
- **ggplot2**: tidyverse's data visualization package
- `gg` in "ggplot2" stands for Grammar of Graphics
- Inspired by the book **Grammar of Graphics** by Leland Wilkinson
- A grammar of graphics is a tool that enables concise description of components of a graphic


&lt;img src="./img/grammar-of-graphics.png" width="80%" /&gt;
]

---


## ggplot2 `\(\in\)` tidyverse

.pull-left[
&lt;img src="./img/tidy-workflow.png" width="100%" /&gt;
]


.pull-right[
&lt;img src="./img/tidy-workflow-packages.png" width="90%" /&gt;
]

---




## Following along...

- Download the materials at and launch `ggplot2.Rproj`
- Install `tidyverse` if you haven't done so before, or if you haven't updated it recently

```r
install.packages("ggplot2", repos = 'http://cran.us.r-project.org')
install.packages("dplyr", repos = 'http://cran.us.r-project.org')
install.packages("readr", repos = 'http://cran.us.r-project.org')
install.packages("ggrepel", repos = 'http://cran.us.r-project.org')
install.packages("plotly", repos = 'http://cran.us.r-project.org')
install.packages("knitr", repos = 'http://cran.us.r-project.org')
install.packages("patchwork", repos = 'http://cran.us.r-project.org'))
```
- Load libraries


```r
library(ggplot2)
library(dplyr)
library(readr)
library(plotly)
library(ggrepel)
library(patchwork)
```
- Open `ggplot2.Rmd` to follow along in markdown document

---


## Dataset

[Stanford Open Policing Project](https://openpolicing.stanford.edu/)


[Police Searches Drop Dramatically in States that Legalized Marijuana](https://www.nbcnews.com/news/us-news/police-searches-drop-dramatically-states-legalized-marijuana-n776146)

* Police Stop Data
  - state, driver race, stop rate, marijuana legalization status


```r
stops &lt;- read_csv("../data/opp-search-marijuana_state.csv") %&gt;% 
  filter(state %in% c("WA", "CO")) %&gt;% 
  mutate(legalization_status = ifelse(quarter &lt;= "2013-01-01", "pre","post"),
         search_rate_100 = search_rate * 100) 
```



---
class: center, middle

# Layer up!
---
 


```
## `geom_smooth()` using formula 'y ~ x'
```

&lt;img src="index_files/figure-html/unnamed-chunk-8-1.png" width="100%" /&gt;
---

## Basic ggplot2 syntax

* DATA
* MAPPING
* GEOM

---


## Your turn!

**Exercise:** Determine which variable is mapped to which aesthetic (x-axis, y-axis, etc.) element 
of the dataset.

&lt;img src="index_files/figure-html/unnamed-chunk-9-1.png" width="70%" /&gt;


---

class: center, middle

# Step-by-step

---


```r
ggplot(data = stops)
```

![](index_files/figure-html/unnamed-chunk-10-1.png)&lt;!-- --&gt;

---


```r
ggplot(data = stops, mapping = aes(x = quarter, y = search_rate_100))
```

![](index_files/figure-html/unnamed-chunk-11-1.png)&lt;!-- --&gt;

---


```r
ggplot(data = stops, mapping = aes(x = quarter, y = search_rate_100)) +
  geom_point()
```

![](index_files/figure-html/unnamed-chunk-12-1.png)&lt;!-- --&gt;

---


```r
ggplot(data = stops, aes(x = quarter, y = search_rate_100, color = driver_race)) + 
  geom_point()
```

![](index_files/figure-html/unnamed-chunk-13-1.png)&lt;!-- --&gt;

---



```r
ggplot(data = stops, aes(x = quarter, y = search_rate_100, color = driver_race)) + 
  geom_smooth()
```

```
## `geom_smooth()` using method = 'loess' and formula 'y ~ x'
```

![](index_files/figure-html/unnamed-chunk-14-1.png)&lt;!-- --&gt;

---


```r
ggplot(data = stops, aes(x = quarter, y = search_rate_100, color = driver_race)) + 
  geom_smooth(method = "loess")
```

```
## `geom_smooth()` using formula 'y ~ x'
```

![](index_files/figure-html/unnamed-chunk-15-1.png)&lt;!-- --&gt;

---


```r
ggplot(data = stops, aes(x = quarter, y = search_rate_100, color = driver_race)) + 
  geom_smooth(method = "loess", se = FALSE)
```

```
## `geom_smooth()` using formula 'y ~ x'
```

![](index_files/figure-html/unnamed-chunk-16-1.png)&lt;!-- --&gt;

---



```r
ggplot(data = stops, aes(x = quarter, y = search_rate_100, color = driver_race)) + 
  geom_smooth(method = "loess", se = FALSE) +
  scale_color_viridis_d()
```

```
## `geom_smooth()` using formula 'y ~ x'
```

![](index_files/figure-html/unnamed-chunk-17-1.png)&lt;!-- --&gt;


---


```r
ggplot(data = stops, aes(x = quarter, y = search_rate_100, color = driver_race)) + 
  geom_smooth(method = "loess", se = FALSE) +
  scale_color_viridis_d() +
  theme_minimal()
```

```
## `geom_smooth()` using formula 'y ~ x'
```

![](index_files/figure-html/unnamed-chunk-18-1.png)&lt;!-- --&gt;

---



```r
ggplot(data = stops, aes(x = quarter, y = search_rate_100, color = driver_race)) + 
  geom_smooth(method = "loess", se = FALSE) +
  scale_color_viridis_d() +
  theme_minimal() +
  labs(x = "Year", y = "Search Rate", color = "Driver Race",
       title = "Washington Highway Patrol Searches", subtitle = "Searches Per Hundred stops")
```

```
## `geom_smooth()` using formula 'y ~ x'
```

![](index_files/figure-html/unnamed-chunk-19-1.png)&lt;!-- --&gt;

---


## ggplot, the making of

1. "Initialize" a plot with ggplot()
2. Add layers with geom_ functions

```
ggplot(data = &lt;DATA&gt;) +
  &lt;GEOM_FUNCTION&gt;(mapping = aes(&lt;MAPPINGS&gt;))+
  geom_point(mapping = aes(x = displ, y = hwy))
```

---


class: center, middle

# Mapping

---


## Size data points by a numerical variable


```r
ggplot(data = stops, aes(x = quarter, y = search_rate_100, size = search_rate_100)) +
  geom_point()
```

![](index_files/figure-html/unnamed-chunk-20-1.png)&lt;!-- --&gt;

---


## Set alpha value


```r
ggplot(data = stops, aes(x = quarter, y = search_rate_100, size = search_rate_100)) +
  geom_point(alpha = 0.5)
```

![](index_files/figure-html/unnamed-chunk-21-1.png)&lt;!-- --&gt;

---


## Your turn!

**Exercise:** Using information from https://ggplot2.tidyverse.org/articles/ggplot2-specs.html add color, size, alpha, and shape aesthetics to your graph. Experiment. Do different things 
happen when you map aesthetics to  discrete and continuous variables?
What happens when you use more than one aesthetic?


```r
stops %&gt;% ggplot(aes(x = quarter , y = search_rate_100, color = driver_race)) + 
  geom_point() + 
  theme_minimal(base_size = 12)  
```


---

&lt;img src="./img/aesthetic-mappings.png" width="80%" /&gt;

---

## Mappings can be at the `geom` level


```r
ggplot(data = stops) +
  geom_point(mapping = aes(x = quarter, y = search_rate_100))
```

![](index_files/figure-html/unnamed-chunk-24-1.png)&lt;!-- --&gt;

---

## Different mappings for different `geom`s


```r
ggplot(data = stops, mapping = aes(x = quarter, y = search_rate_100)) +
  geom_point() +
  geom_smooth(aes(color = driver_race), method = "loess", se = FALSE)
```

```
## `geom_smooth()` using formula 'y ~ x'
```

![](index_files/figure-html/unnamed-chunk-25-1.png)&lt;!-- --&gt;


---

### Set vs. map

- To **map** an aesthetic to a variable, place it inside `aes()`


```r
ggplot(data = stops, 
  mapping = aes(x = quarter, 
                y = search_rate_100,
            color = driver_race)) +
  geom_point() 
```

![](index_files/figure-html/unnamed-chunk-26-1.png)&lt;!-- --&gt;

---

- To **set** an aesthetic to a value, place it outside `aes()`

```r
ggplot(data = stops, 
  mapping = aes(x = quarter, 
                y = search_rate_100)) +
  geom_point(color = "red") 
```

![](index_files/figure-html/unnamed-chunk-27-1.png)&lt;!-- --&gt;
---


- Can specify HTML color codes (tip: Add-ins &gt; colour picker)

```r
ggplot(data = stops, 
  mapping = aes(x = quarter, 
                y = search_rate_100)) + 
  geom_point(color = "#63B3E8") 
```

![](index_files/figure-html/unnamed-chunk-28-1.png)&lt;!-- --&gt;

---



## Data can be passed in


```r
stops %&gt;%
  ggplot(aes(x = quarter, y = search_rate_100)) +
    geom_point()
```

![](index_files/figure-html/unnamed-chunk-29-1.png)&lt;!-- --&gt;

---

## Parameters can be unnamed


```r
ggplot(stops, aes(x = quarter, y = search_rate_100)) +
  geom_point()
```

![](index_files/figure-html/unnamed-chunk-30-1.png)&lt;!-- --&gt;


---

## Assign ggplot() to objects for layering


```r
p &lt;- ggplot(stops, aes(x = quarter, y = search_rate_100)) +
  geom_point()

p + geom_smooth()
```

```
## `geom_smooth()` using method = 'loess' and formula 'y ~ x'
```

![](index_files/figure-html/unnamed-chunk-31-1.png)&lt;!-- --&gt;



---

class: center, middle

# Common early pitfalls

---

## Mappings that aren't


```r
ggplot(data = stops) +
  geom_point(aes(x = quarter, y = search_rate_100, color = "blue")) 
```

![](index_files/figure-html/unnamed-chunk-32-1.png)&lt;!-- --&gt;

---
## Mappings that aren't


```r
ggplot(data = stops) +
  geom_point(aes(x = quarter, y = search_rate_100), color = "blue")
```

![](index_files/figure-html/unnamed-chunk-33-1.png)&lt;!-- --&gt;

---

## Your turn!

**Exercise:** What is wrong with the following?


```r
stops %&gt;%
  ggplot(aes(x = quarter, y = search_rate_100, color = legalization_status)) %&gt;%
    geom_point()
```


---


## + and %&gt;%

What is wrong with the following?


```r
stops %&gt;%
  ggplot(aes(x = quarter, y = search_rate_100, color = legalization_status)) %&gt;%
    geom_point()
```

```
## Error: `mapping` must be created by `aes()`
## Did you use %&gt;% instead of +?
```

---
## Building up layer by layer

### Basic plot


```r
ggplot(data = stops, aes(x = quarter, y = search_rate_100)) +
  geom_point() 
```

![](index_files/figure-html/unnamed-chunk-36-1.png)&lt;!-- --&gt;

---

## Two layers!


```r
ggplot(data = stops, aes(x = quarter, y = search_rate_100)) +
  geom_point()  +
  geom_line()
```

![](index_files/figure-html/unnamed-chunk-37-1.png)&lt;!-- --&gt;

---


## Grouping with colors


```r
ggplot(data = stops, aes(x = quarter, y = search_rate_100, color = driver_race)) +
  geom_point() + 
  geom_line()
```

![](index_files/figure-html/unnamed-chunk-38-1.png)&lt;!-- --&gt;

---

## Now we've got it


```r
ggplot(data = stops, aes(x = quarter, y = search_rate_100, color = driver_race)) +
  geom_smooth(span = .2, se = FALSE)
```

```
## `geom_smooth()` using method = 'loess' and formula 'y ~ x'
```

![](index_files/figure-html/unnamed-chunk-39-1.png)&lt;!-- --&gt;

---

## Control data by layer


```r
ggplot(data = stops, aes(x = quarter, y = search_rate_100, color = driver_race)) +
  geom_point(data = filter(stops, search_rate_100 &lt; .2),
             size = 5, color = "gray") +
  geom_point()
```

![](index_files/figure-html/unnamed-chunk-40-1.png)&lt;!-- --&gt;

---

## Your turn!

**Exercise:** Work with your neighbor to sketch what the following plots will 
look like. Do not run the code, just think through the code for 
the time being.


```r
pre_legalization_high &lt;- stops %&gt;%
  filter((quarter &lt; "2013-01-01" &amp; search_rate_100 &gt; 1.0))
```


```r
ggplot(stops, aes(x = quarter, y = search_rate_100, color = driver_race)) +
  geom_point(data = pre_legalization_high, size = 5, color = "gray") +
  geom_point() +
  geom_text(data = pre_legalization_high, aes(y = search_rate_100 + .05, label = search_rate_100), 
            size = 2, color = "black")
```

---



```r
ggplot(stops, aes(x = quarter, y = search_rate_100, color = driver_race)) +
  geom_point()
```

![](index_files/figure-html/unnamed-chunk-43-1.png)&lt;!-- --&gt;

---


```r
ggplot(stops, aes(x = quarter, y = search_rate_100, color = driver_race)) +
  geom_point() +
  geom_point(data = pre_legalization_high, size = 5, color = "gray")
```

![](index_files/figure-html/unnamed-chunk-44-1.png)&lt;!-- --&gt;


---


```r
ggplot(stops, aes(x = quarter, y = search_rate_100, color = driver_race)) +
  geom_point(data = pre_legalization_high, size = 5, color = "gray") +
  geom_point()
```

![](index_files/figure-html/unnamed-chunk-45-1.png)&lt;!-- --&gt;


---



```r
ggplot(stops, aes(x = quarter, y = search_rate_100, color = driver_race)) +
  geom_point(data = pre_legalization_high, size = 5, color = "gray") +
  geom_point() +
  geom_text(data = pre_legalization_high, aes(y = search_rate_100, label = search_rate_100), 
            size = 2, color = "black")
```

![](index_files/figure-html/unnamed-chunk-46-1.png)&lt;!-- --&gt;

---



```r
ggplot(stops, aes(x = quarter, y = search_rate_100, color = driver_race)) +
  geom_point(data = pre_legalization_high, size = 5, color = "gray") +
  geom_point() +
  geom_text(data = pre_legalization_high, aes(y = search_rate_100 + .05, label = search_rate_100), 
            size = 2, color = "black")
```

![](index_files/figure-html/unnamed-chunk-47-1.png)&lt;!-- --&gt;

---


```r
ggplot(stops, aes(x = quarter, y = search_rate_100, color = driver_race)) +
  geom_point(data = pre_legalization_high, size = 5, color = "gray") +
  geom_point() + 
  geom_text_repel(data = pre_legalization_high, 
                  aes(x = quarter, y = search_rate_100, 
                      label = as.character(quarter)), 
                  size = 3, color = "black")
```

![](index_files/figure-html/unnamed-chunk-48-1.png)&lt;!-- --&gt;


---


```r
ggplot(stops, aes(x = quarter, y = search_rate_100, color = driver_race)) +
  geom_point(data = pre_legalization_high, size = 5, color = "gray") +
  geom_point() + 
  geom_label_repel(data = pre_legalization_high, 
                  aes(x = quarter, y = search_rate_100, 
                      label = as.character(quarter)), 
                  size = 3, color = "black")
```

![](index_files/figure-html/unnamed-chunk-49-1.png)&lt;!-- --&gt;


---


**Exercise:** How would you fix the following plot?


```r
ggplot(stops, aes(x = quarter, y = search_rate_100, color = driver_race)) +
  geom_smooth(color = "blue")
```

```
## `geom_smooth()` using method = 'loess' and formula 'y ~ x'
```

![](index_files/figure-html/unnamed-chunk-50-1.png)&lt;!-- --&gt;

---

### More on colors


```r
ggplot(stops, aes(x = quarter, y = search_rate_100, color = driver_race)) +
  scale_color_manual(values = c("#FF6EB4", "#00BFFF", "#008B8B")) + 
  geom_smooth(se = FALSE)
```

![](index_files/figure-html/unnamed-chunk-51-1.png)&lt;!-- --&gt;
---

### Splitting over facets



```r
ggplot(data = stops, aes(x = quarter, y = search_rate_100)) +
  geom_smooth() +
  facet_wrap( ~ driver_race)
```

![](index_files/figure-html/unnamed-chunk-52-1.png)&lt;!-- --&gt;

---

### facet_grid


```r
ggplot(data = stops, aes(x = quarter, y = search_rate_100)) +
  geom_line() +
  facet_grid(state ~ driver_race)
```

![](index_files/figure-html/unnamed-chunk-53-1.png)&lt;!-- --&gt;


---

### facet_grid


```r
ggplot(data = stops, aes(x = quarter, y = search_rate_100)) +
  geom_line() +
  facet_grid(driver_race ~ state)
```

![](index_files/figure-html/unnamed-chunk-54-1.png)&lt;!-- --&gt;

---

## facet_wrap vs. facet_grid

![](https://i.stack.imgur.com/oUXZU.png)


---


# Scales and legends


---

## Scale transformation


```r
ggplot(data = stops, aes(x = quarter, y = search_rate_100, color = driver_race)) +
  geom_point() +
  scale_y_reverse()
```

![](index_files/figure-html/unnamed-chunk-55-1.png)&lt;!-- --&gt;

---

## Scale transformation


```r
ggplot(data = stops, aes(x = quarter, y = search_rate_100, color = driver_race)) +
  geom_point() +
  scale_y_sqrt()
```

![](index_files/figure-html/unnamed-chunk-56-1.png)&lt;!-- --&gt;

---

## Scale details


```r
ggplot(data = stops, aes(x = quarter, y = search_rate_100, color = driver_race)) +
  geom_point() +
  scale_y_continuous(breaks = c(0, 0.25, 0.5, .75, 1.0))
```

![](index_files/figure-html/unnamed-chunk-57-1.png)&lt;!-- --&gt;
---

## Overall themes


```r
ggplot(data = stops, aes(x = quarter, y = search_rate_100, color = driver_race)) +
  geom_point() +
  theme_bw()
```

![](index_files/figure-html/unnamed-chunk-58-1.png)&lt;!-- --&gt;

---

## Overall themes


```r
ggplot(data = stops, aes(x = quarter, y = search_rate_100, color = driver_race)) +
  geom_point() +
  theme_dark() 
```

![](index_files/figure-html/unnamed-chunk-59-1.png)&lt;!-- --&gt;

---


## Customizing theme elements


```r
ggplot(data = stops, aes(x = quarter, y = search_rate_100, color = driver_race)) +
  geom_point() +
  theme(axis.text.x = element_text(angle = 45))
```

![](index_files/figure-html/unnamed-chunk-60-1.png)&lt;!-- --&gt;

---

## Combining several plots to a grid


```r
wa_stops &lt;- stops %&gt;% filter(state == "WA") %&gt;% ggplot(aes(x = quarter, y = search_rate_100, color = driver_race)) + 
  geom_smooth(se = FALSE) + 
  labs(title = "Washington")

co_stops &lt;- stops %&gt;% filter(state == "CO") %&gt;% ggplot(aes(x = quarter, y = search_rate_100, color = driver_race)) + 
  geom_smooth(se = FALSE) + 
  labs(title = "Colorado") + 
  theme(legend.position = "none")
```

---

## Combining several plots to a grid


```r
(wa_stops / co_stops)
```

&lt;img src="index_files/figure-html/unnamed-chunk-62-1.png" width="75%" /&gt;

---

## Combining several plots to a grid


```r
wa_stops + co_stops
```

&lt;img src="index_files/figure-html/unnamed-chunk-63-1.png" width="75%" /&gt;

---
### Interactivity


```r
wa_stops &lt;- wa_stops + geom_point()
plotly::ggplotly(wa_stops)
```

<div id="htmlwidget-b6f008b1fc6d1c70d12d" style="width:80%;height:50%;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-b6f008b1fc6d1c70d12d">{"x":{"data":[{"x":[15020,15041.9493670886,15063.8987341772,15085.8481012658,15107.7974683544,15129.746835443,15151.6962025316,15173.6455696203,15195.5949367089,15217.5443037975,15239.4936708861,15261.4430379747,15283.3924050633,15305.3417721519,15327.2911392405,15349.2405063291,15371.1898734177,15393.1392405063,15415.0886075949,15437.0379746835,15458.9873417722,15480.9367088608,15502.8860759494,15524.835443038,15546.7848101266,15568.7341772152,15590.6835443038,15612.6329113924,15634.582278481,15656.5316455696,15678.4810126582,15700.4303797468,15722.3797468354,15744.3291139241,15766.2784810127,15788.2278481013,15810.1772151899,15832.1265822785,15854.0759493671,15876.0253164557,15897.9746835443,15919.9240506329,15941.8734177215,15963.8227848101,15985.7721518987,16007.7215189873,16029.6708860759,16051.6202531646,16073.5696202532,16095.5189873418,16117.4683544304,16139.417721519,16161.3670886076,16183.3164556962,16205.2658227848,16227.2151898734,16249.164556962,16271.1139240506,16293.0632911392,16315.0126582278,16336.9620253165,16358.9113924051,16380.8607594937,16402.8101265823,16424.7594936709,16446.7088607595,16468.6582278481,16490.6075949367,16512.5569620253,16534.5063291139,16556.4556962025,16578.4050632911,16600.3544303797,16622.3037974684,16644.253164557,16666.2025316456,16688.1518987342,16710.1012658228,16732.0506329114,16754],"y":[0.423686069201849,0.431388330794485,0.438485706367284,0.44475125446475,0.449958033631388,0.454159293647685,0.457608339927859,0.460291789188846,0.46219542323078,0.463223705424581,0.463223625701296,0.46228327397128,0.460500552784667,0.457973364691592,0.454799612242191,0.451077197986599,0.446904024474951,0.442301923873413,0.43658697838991,0.429726170866081,0.421911705512017,0.413335786537807,0.40419061815354,0.394668404569307,0.384961349995196,0.375243730045545,0.362627149988408,0.345794675892283,0.326018225431465,0.304569716280252,0.282721066112937,0.261744192603817,0.242911013427188,0.227493446257347,0.215378445515619,0.203273930954296,0.191168784253014,0.179299979355251,0.167904490204485,0.157219290744193,0.147481354917853,0.138927656668944,0.131878955647529,0.126957051092453,0.123889465432245,0.12224465919348,0.121591092902732,0.121497227086579,0.121531522271594,0.121262438984353,0.120268287284903,0.120376354145724,0.122094285406061,0.123847600776788,0.124062084433582,0.12325715308098,0.122832513491276,0.122664060168714,0.12262768761754,0.122599290342002,0.122454762846344,0.122069999634814,0.121320895211657,0.12020297261361,0.119080136482265,0.117968802553519,0.116846154421449,0.115689375680138,0.114475649923664,0.113182160746107,0.111786091741548,0.110267773138236,0.108645020639874,0.106929726123026,0.105127408662702,0.103243587333909,0.101283781211655,0.0992535093709501,0.0971582908868012,0.095003644834217],"text":["quarter: 15020.00<br />search_rate_100: 0.42368607<br />driver_race: black","quarter: 15041.95<br />search_rate_100: 0.43138833<br />driver_race: black","quarter: 15063.90<br />search_rate_100: 0.43848571<br />driver_race: black","quarter: 15085.85<br />search_rate_100: 0.44475125<br />driver_race: black","quarter: 15107.80<br />search_rate_100: 0.44995803<br />driver_race: black","quarter: 15129.75<br />search_rate_100: 0.45415929<br />driver_race: black","quarter: 15151.70<br />search_rate_100: 0.45760834<br />driver_race: black","quarter: 15173.65<br />search_rate_100: 0.46029179<br />driver_race: black","quarter: 15195.59<br />search_rate_100: 0.46219542<br />driver_race: black","quarter: 15217.54<br />search_rate_100: 0.46322371<br />driver_race: black","quarter: 15239.49<br />search_rate_100: 0.46322363<br />driver_race: black","quarter: 15261.44<br />search_rate_100: 0.46228327<br />driver_race: black","quarter: 15283.39<br />search_rate_100: 0.46050055<br />driver_race: black","quarter: 15305.34<br />search_rate_100: 0.45797336<br />driver_race: black","quarter: 15327.29<br />search_rate_100: 0.45479961<br />driver_race: black","quarter: 15349.24<br />search_rate_100: 0.45107720<br />driver_race: black","quarter: 15371.19<br />search_rate_100: 0.44690402<br />driver_race: black","quarter: 15393.14<br />search_rate_100: 0.44230192<br />driver_race: black","quarter: 15415.09<br />search_rate_100: 0.43658698<br />driver_race: black","quarter: 15437.04<br />search_rate_100: 0.42972617<br />driver_race: black","quarter: 15458.99<br />search_rate_100: 0.42191171<br />driver_race: black","quarter: 15480.94<br />search_rate_100: 0.41333579<br />driver_race: black","quarter: 15502.89<br />search_rate_100: 0.40419062<br />driver_race: black","quarter: 15524.84<br />search_rate_100: 0.39466840<br />driver_race: black","quarter: 15546.78<br />search_rate_100: 0.38496135<br />driver_race: black","quarter: 15568.73<br />search_rate_100: 0.37524373<br />driver_race: black","quarter: 15590.68<br />search_rate_100: 0.36262715<br />driver_race: black","quarter: 15612.63<br />search_rate_100: 0.34579468<br />driver_race: black","quarter: 15634.58<br />search_rate_100: 0.32601823<br />driver_race: black","quarter: 15656.53<br />search_rate_100: 0.30456972<br />driver_race: black","quarter: 15678.48<br />search_rate_100: 0.28272107<br />driver_race: black","quarter: 15700.43<br />search_rate_100: 0.26174419<br />driver_race: black","quarter: 15722.38<br />search_rate_100: 0.24291101<br />driver_race: black","quarter: 15744.33<br />search_rate_100: 0.22749345<br />driver_race: black","quarter: 15766.28<br />search_rate_100: 0.21537845<br />driver_race: black","quarter: 15788.23<br />search_rate_100: 0.20327393<br />driver_race: black","quarter: 15810.18<br />search_rate_100: 0.19116878<br />driver_race: black","quarter: 15832.13<br />search_rate_100: 0.17929998<br />driver_race: black","quarter: 15854.08<br />search_rate_100: 0.16790449<br />driver_race: black","quarter: 15876.03<br />search_rate_100: 0.15721929<br />driver_race: black","quarter: 15897.97<br />search_rate_100: 0.14748135<br />driver_race: black","quarter: 15919.92<br />search_rate_100: 0.13892766<br />driver_race: black","quarter: 15941.87<br />search_rate_100: 0.13187896<br />driver_race: black","quarter: 15963.82<br />search_rate_100: 0.12695705<br />driver_race: black","quarter: 15985.77<br />search_rate_100: 0.12388947<br />driver_race: black","quarter: 16007.72<br />search_rate_100: 0.12224466<br />driver_race: black","quarter: 16029.67<br />search_rate_100: 0.12159109<br />driver_race: black","quarter: 16051.62<br />search_rate_100: 0.12149723<br />driver_race: black","quarter: 16073.57<br />search_rate_100: 0.12153152<br />driver_race: black","quarter: 16095.52<br />search_rate_100: 0.12126244<br />driver_race: black","quarter: 16117.47<br />search_rate_100: 0.12026829<br />driver_race: black","quarter: 16139.42<br />search_rate_100: 0.12037635<br />driver_race: black","quarter: 16161.37<br />search_rate_100: 0.12209429<br />driver_race: black","quarter: 16183.32<br />search_rate_100: 0.12384760<br />driver_race: black","quarter: 16205.27<br />search_rate_100: 0.12406208<br />driver_race: black","quarter: 16227.22<br />search_rate_100: 0.12325715<br />driver_race: black","quarter: 16249.16<br />search_rate_100: 0.12283251<br />driver_race: black","quarter: 16271.11<br />search_rate_100: 0.12266406<br />driver_race: black","quarter: 16293.06<br />search_rate_100: 0.12262769<br />driver_race: black","quarter: 16315.01<br />search_rate_100: 0.12259929<br />driver_race: black","quarter: 16336.96<br />search_rate_100: 0.12245476<br />driver_race: black","quarter: 16358.91<br />search_rate_100: 0.12207000<br />driver_race: black","quarter: 16380.86<br />search_rate_100: 0.12132090<br />driver_race: black","quarter: 16402.81<br />search_rate_100: 0.12020297<br />driver_race: black","quarter: 16424.76<br />search_rate_100: 0.11908014<br />driver_race: black","quarter: 16446.71<br />search_rate_100: 0.11796880<br />driver_race: black","quarter: 16468.66<br />search_rate_100: 0.11684615<br />driver_race: black","quarter: 16490.61<br />search_rate_100: 0.11568938<br />driver_race: black","quarter: 16512.56<br />search_rate_100: 0.11447565<br />driver_race: black","quarter: 16534.51<br />search_rate_100: 0.11318216<br />driver_race: black","quarter: 16556.46<br />search_rate_100: 0.11178609<br />driver_race: black","quarter: 16578.41<br />search_rate_100: 0.11026777<br />driver_race: black","quarter: 16600.35<br />search_rate_100: 0.10864502<br />driver_race: black","quarter: 16622.30<br />search_rate_100: 0.10692973<br />driver_race: black","quarter: 16644.25<br />search_rate_100: 0.10512741<br />driver_race: black","quarter: 16666.20<br />search_rate_100: 0.10324359<br />driver_race: black","quarter: 16688.15<br />search_rate_100: 0.10128378<br />driver_race: black","quarter: 16710.10<br />search_rate_100: 0.09925351<br />driver_race: black","quarter: 16732.05<br />search_rate_100: 0.09715829<br />driver_race: black","quarter: 16754.00<br />search_rate_100: 0.09500364<br />driver_race: black"],"type":"scatter","mode":"lines","name":"black","line":{"width":3.77952755905512,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","legendgroup":"black","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[15020,15041.9493670886,15063.8987341772,15085.8481012658,15107.7974683544,15129.746835443,15151.6962025316,15173.6455696203,15195.5949367089,15217.5443037975,15239.4936708861,15261.4430379747,15283.3924050633,15305.3417721519,15327.2911392405,15349.2405063291,15371.1898734177,15393.1392405063,15415.0886075949,15437.0379746835,15458.9873417722,15480.9367088608,15502.8860759494,15524.835443038,15546.7848101266,15568.7341772152,15590.6835443038,15612.6329113924,15634.582278481,15656.5316455696,15678.4810126582,15700.4303797468,15722.3797468354,15744.3291139241,15766.2784810127,15788.2278481013,15810.1772151899,15832.1265822785,15854.0759493671,15876.0253164557,15897.9746835443,15919.9240506329,15941.8734177215,15963.8227848101,15985.7721518987,16007.7215189873,16029.6708860759,16051.6202531646,16073.5696202532,16095.5189873418,16117.4683544304,16139.417721519,16161.3670886076,16183.3164556962,16205.2658227848,16227.2151898734,16249.164556962,16271.1139240506,16293.0632911392,16315.0126582278,16336.9620253165,16358.9113924051,16380.8607594937,16402.8101265823,16424.7594936709,16446.7088607595,16468.6582278481,16490.6075949367,16512.5569620253,16534.5063291139,16556.4556962025,16578.4050632911,16600.3544303797,16622.3037974684,16644.253164557,16666.2025316456,16688.1518987342,16710.1012658228,16732.0506329114,16754],"y":[0.326573112421228,0.338371960852475,0.349503089470408,0.359802733535851,0.369107128309627,0.377456167085802,0.385035033771682,0.391834998095774,0.397846722828589,0.403005713851485,0.407208037821177,0.410512870791142,0.412986035569114,0.414693354962827,0.415700651780014,0.416073748828409,0.415878468915746,0.415103120173861,0.413037073687906,0.409673026061842,0.405237429425171,0.399956735907396,0.394057397638017,0.387765866746538,0.381308595362459,0.374899029578341,0.366499782975671,0.355113922582431,0.34160138572762,0.326822109740238,0.311636031949283,0.296903089683755,0.283483220272653,0.272236361044977,0.262988112286132,0.253273753440698,0.243167284106293,0.232930681128117,0.222825921351371,0.213114981621255,0.204059838782969,0.195922469681715,0.188943735753847,0.183070107804694,0.178099661154175,0.173839089734583,0.170095087478208,0.166674348317342,0.163383566184279,0.160029435011309,0.156421205804253,0.152992306457836,0.149974910689887,0.147091478896219,0.144064508436211,0.14092548271392,0.13789281692957,0.134987537537251,0.132230670991052,0.129643243745064,0.127246282253375,0.125060812970076,0.123107862349256,0.121391885969302,0.119862768972309,0.1185142486074,0.117345313016363,0.116354950340989,0.115542148723066,0.114905896304386,0.114445181226736,0.114159427895761,0.114052318239375,0.114124891707841,0.114377117116085,0.114808963279036,0.11542039901162,0.116211393128765,0.117181914445398,0.118331931776447],"text":["quarter: 15020.00<br />search_rate_100: 0.32657311<br />driver_race: hispanic","quarter: 15041.95<br />search_rate_100: 0.33837196<br />driver_race: hispanic","quarter: 15063.90<br />search_rate_100: 0.34950309<br />driver_race: hispanic","quarter: 15085.85<br />search_rate_100: 0.35980273<br />driver_race: hispanic","quarter: 15107.80<br />search_rate_100: 0.36910713<br />driver_race: hispanic","quarter: 15129.75<br />search_rate_100: 0.37745617<br />driver_race: hispanic","quarter: 15151.70<br />search_rate_100: 0.38503503<br />driver_race: hispanic","quarter: 15173.65<br />search_rate_100: 0.39183500<br />driver_race: hispanic","quarter: 15195.59<br />search_rate_100: 0.39784672<br />driver_race: hispanic","quarter: 15217.54<br />search_rate_100: 0.40300571<br />driver_race: hispanic","quarter: 15239.49<br />search_rate_100: 0.40720804<br />driver_race: hispanic","quarter: 15261.44<br />search_rate_100: 0.41051287<br />driver_race: hispanic","quarter: 15283.39<br />search_rate_100: 0.41298604<br />driver_race: hispanic","quarter: 15305.34<br />search_rate_100: 0.41469335<br />driver_race: hispanic","quarter: 15327.29<br />search_rate_100: 0.41570065<br />driver_race: hispanic","quarter: 15349.24<br />search_rate_100: 0.41607375<br />driver_race: hispanic","quarter: 15371.19<br />search_rate_100: 0.41587847<br />driver_race: hispanic","quarter: 15393.14<br />search_rate_100: 0.41510312<br />driver_race: hispanic","quarter: 15415.09<br />search_rate_100: 0.41303707<br />driver_race: hispanic","quarter: 15437.04<br />search_rate_100: 0.40967303<br />driver_race: hispanic","quarter: 15458.99<br />search_rate_100: 0.40523743<br />driver_race: hispanic","quarter: 15480.94<br />search_rate_100: 0.39995674<br />driver_race: hispanic","quarter: 15502.89<br />search_rate_100: 0.39405740<br />driver_race: hispanic","quarter: 15524.84<br />search_rate_100: 0.38776587<br />driver_race: hispanic","quarter: 15546.78<br />search_rate_100: 0.38130860<br />driver_race: hispanic","quarter: 15568.73<br />search_rate_100: 0.37489903<br />driver_race: hispanic","quarter: 15590.68<br />search_rate_100: 0.36649978<br />driver_race: hispanic","quarter: 15612.63<br />search_rate_100: 0.35511392<br />driver_race: hispanic","quarter: 15634.58<br />search_rate_100: 0.34160139<br />driver_race: hispanic","quarter: 15656.53<br />search_rate_100: 0.32682211<br />driver_race: hispanic","quarter: 15678.48<br />search_rate_100: 0.31163603<br />driver_race: hispanic","quarter: 15700.43<br />search_rate_100: 0.29690309<br />driver_race: hispanic","quarter: 15722.38<br />search_rate_100: 0.28348322<br />driver_race: hispanic","quarter: 15744.33<br />search_rate_100: 0.27223636<br />driver_race: hispanic","quarter: 15766.28<br />search_rate_100: 0.26298811<br />driver_race: hispanic","quarter: 15788.23<br />search_rate_100: 0.25327375<br />driver_race: hispanic","quarter: 15810.18<br />search_rate_100: 0.24316728<br />driver_race: hispanic","quarter: 15832.13<br />search_rate_100: 0.23293068<br />driver_race: hispanic","quarter: 15854.08<br />search_rate_100: 0.22282592<br />driver_race: hispanic","quarter: 15876.03<br />search_rate_100: 0.21311498<br />driver_race: hispanic","quarter: 15897.97<br />search_rate_100: 0.20405984<br />driver_race: hispanic","quarter: 15919.92<br />search_rate_100: 0.19592247<br />driver_race: hispanic","quarter: 15941.87<br />search_rate_100: 0.18894374<br />driver_race: hispanic","quarter: 15963.82<br />search_rate_100: 0.18307011<br />driver_race: hispanic","quarter: 15985.77<br />search_rate_100: 0.17809966<br />driver_race: hispanic","quarter: 16007.72<br />search_rate_100: 0.17383909<br />driver_race: hispanic","quarter: 16029.67<br />search_rate_100: 0.17009509<br />driver_race: hispanic","quarter: 16051.62<br />search_rate_100: 0.16667435<br />driver_race: hispanic","quarter: 16073.57<br />search_rate_100: 0.16338357<br />driver_race: hispanic","quarter: 16095.52<br />search_rate_100: 0.16002944<br />driver_race: hispanic","quarter: 16117.47<br />search_rate_100: 0.15642121<br />driver_race: hispanic","quarter: 16139.42<br />search_rate_100: 0.15299231<br />driver_race: hispanic","quarter: 16161.37<br />search_rate_100: 0.14997491<br />driver_race: hispanic","quarter: 16183.32<br />search_rate_100: 0.14709148<br />driver_race: hispanic","quarter: 16205.27<br />search_rate_100: 0.14406451<br />driver_race: hispanic","quarter: 16227.22<br />search_rate_100: 0.14092548<br />driver_race: hispanic","quarter: 16249.16<br />search_rate_100: 0.13789282<br />driver_race: hispanic","quarter: 16271.11<br />search_rate_100: 0.13498754<br />driver_race: hispanic","quarter: 16293.06<br />search_rate_100: 0.13223067<br />driver_race: hispanic","quarter: 16315.01<br />search_rate_100: 0.12964324<br />driver_race: hispanic","quarter: 16336.96<br />search_rate_100: 0.12724628<br />driver_race: hispanic","quarter: 16358.91<br />search_rate_100: 0.12506081<br />driver_race: hispanic","quarter: 16380.86<br />search_rate_100: 0.12310786<br />driver_race: hispanic","quarter: 16402.81<br />search_rate_100: 0.12139189<br />driver_race: hispanic","quarter: 16424.76<br />search_rate_100: 0.11986277<br />driver_race: hispanic","quarter: 16446.71<br />search_rate_100: 0.11851425<br />driver_race: hispanic","quarter: 16468.66<br />search_rate_100: 0.11734531<br />driver_race: hispanic","quarter: 16490.61<br />search_rate_100: 0.11635495<br />driver_race: hispanic","quarter: 16512.56<br />search_rate_100: 0.11554215<br />driver_race: hispanic","quarter: 16534.51<br />search_rate_100: 0.11490590<br />driver_race: hispanic","quarter: 16556.46<br />search_rate_100: 0.11444518<br />driver_race: hispanic","quarter: 16578.41<br />search_rate_100: 0.11415943<br />driver_race: hispanic","quarter: 16600.35<br />search_rate_100: 0.11405232<br />driver_race: hispanic","quarter: 16622.30<br />search_rate_100: 0.11412489<br />driver_race: hispanic","quarter: 16644.25<br />search_rate_100: 0.11437712<br />driver_race: hispanic","quarter: 16666.20<br />search_rate_100: 0.11480896<br />driver_race: hispanic","quarter: 16688.15<br />search_rate_100: 0.11542040<br />driver_race: hispanic","quarter: 16710.10<br />search_rate_100: 0.11621139<br />driver_race: hispanic","quarter: 16732.05<br />search_rate_100: 0.11718191<br />driver_race: hispanic","quarter: 16754.00<br />search_rate_100: 0.11833193<br />driver_race: hispanic"],"type":"scatter","mode":"lines","name":"hispanic","line":{"width":3.77952755905512,"color":"rgba(0,186,56,1)","dash":"solid"},"hoveron":"points","legendgroup":"hispanic","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[15020,15041.9493670886,15063.8987341772,15085.8481012658,15107.7974683544,15129.746835443,15151.6962025316,15173.6455696203,15195.5949367089,15217.5443037975,15239.4936708861,15261.4430379747,15283.3924050633,15305.3417721519,15327.2911392405,15349.2405063291,15371.1898734177,15393.1392405063,15415.0886075949,15437.0379746835,15458.9873417722,15480.9367088608,15502.8860759494,15524.835443038,15546.7848101266,15568.7341772152,15590.6835443038,15612.6329113924,15634.582278481,15656.5316455696,15678.4810126582,15700.4303797468,15722.3797468354,15744.3291139241,15766.2784810127,15788.2278481013,15810.1772151899,15832.1265822785,15854.0759493671,15876.0253164557,15897.9746835443,15919.9240506329,15941.8734177215,15963.8227848101,15985.7721518987,16007.7215189873,16029.6708860759,16051.6202531646,16073.5696202532,16095.5189873418,16117.4683544304,16139.417721519,16161.3670886076,16183.3164556962,16205.2658227848,16227.2151898734,16249.164556962,16271.1139240506,16293.0632911392,16315.0126582278,16336.9620253165,16358.9113924051,16380.8607594937,16402.8101265823,16424.7594936709,16446.7088607595,16468.6582278481,16490.6075949367,16512.5569620253,16534.5063291139,16556.4556962025,16578.4050632911,16600.3544303797,16622.3037974684,16644.253164557,16666.2025316456,16688.1518987342,16710.1012658228,16732.0506329114,16754],"y":[0.203074565549727,0.209651064347455,0.215831964246264,0.221484892498891,0.226477476358073,0.230844307831856,0.234734872807751,0.238137212720558,0.241038868056121,0.243381130524613,0.245076049022215,0.246176001976239,0.246739016533675,0.246823119841516,0.246486339046751,0.245786701296372,0.244782233737369,0.243477511599147,0.241387849210061,0.238499095895223,0.2349567556079,0.230906332301361,0.226493329928872,0.221863252443701,0.217161603799116,0.212523594715465,0.20631378200489,0.197756801605291,0.187554647953128,0.176409315484865,0.16502279863696,0.154097091845875,0.144334189548071,0.136436086180011,0.130364490358474,0.124356856375096,0.118378018395869,0.112524617038024,0.106893292918791,0.1015806866554,0.0966834388650799,0.0922981901650618,0.0885960411349122,0.0860931937743513,0.0846437864163785,0.0839717698570882,0.083801094892575,0.0838557123189333,0.0838595729322576,0.0835366275286423,0.0826130338643658,0.0814120008961479,0.0802875802941187,0.079198522495655,0.0781035819459612,0.076997876083955,0.0759079606140756,0.0748417145318574,0.0738070168328344,0.072811746512541,0.0718637825665113,0.0709710039902796,0.0701412897793801,0.06937258074372,0.0686349854957991,0.0679308301204209,0.0672658434961304,0.0666457545014721,0.066076292014991,0.0655631849152317,0.0651121620807391,0.0647281545969784,0.0644065282221113,0.0641440317961477,0.063939017702427,0.0637898383242888,0.0636948460450723,0.063652393248117,0.0636608323167622,0.0637185156343473],"text":["quarter: 15020.00<br />search_rate_100: 0.20307457<br />driver_race: white","quarter: 15041.95<br />search_rate_100: 0.20965106<br />driver_race: white","quarter: 15063.90<br />search_rate_100: 0.21583196<br />driver_race: white","quarter: 15085.85<br />search_rate_100: 0.22148489<br />driver_race: white","quarter: 15107.80<br />search_rate_100: 0.22647748<br />driver_race: white","quarter: 15129.75<br />search_rate_100: 0.23084431<br />driver_race: white","quarter: 15151.70<br />search_rate_100: 0.23473487<br />driver_race: white","quarter: 15173.65<br />search_rate_100: 0.23813721<br />driver_race: white","quarter: 15195.59<br />search_rate_100: 0.24103887<br />driver_race: white","quarter: 15217.54<br />search_rate_100: 0.24338113<br />driver_race: white","quarter: 15239.49<br />search_rate_100: 0.24507605<br />driver_race: white","quarter: 15261.44<br />search_rate_100: 0.24617600<br />driver_race: white","quarter: 15283.39<br />search_rate_100: 0.24673902<br />driver_race: white","quarter: 15305.34<br />search_rate_100: 0.24682312<br />driver_race: white","quarter: 15327.29<br />search_rate_100: 0.24648634<br />driver_race: white","quarter: 15349.24<br />search_rate_100: 0.24578670<br />driver_race: white","quarter: 15371.19<br />search_rate_100: 0.24478223<br />driver_race: white","quarter: 15393.14<br />search_rate_100: 0.24347751<br />driver_race: white","quarter: 15415.09<br />search_rate_100: 0.24138785<br />driver_race: white","quarter: 15437.04<br />search_rate_100: 0.23849910<br />driver_race: white","quarter: 15458.99<br />search_rate_100: 0.23495676<br />driver_race: white","quarter: 15480.94<br />search_rate_100: 0.23090633<br />driver_race: white","quarter: 15502.89<br />search_rate_100: 0.22649333<br />driver_race: white","quarter: 15524.84<br />search_rate_100: 0.22186325<br />driver_race: white","quarter: 15546.78<br />search_rate_100: 0.21716160<br />driver_race: white","quarter: 15568.73<br />search_rate_100: 0.21252359<br />driver_race: white","quarter: 15590.68<br />search_rate_100: 0.20631378<br />driver_race: white","quarter: 15612.63<br />search_rate_100: 0.19775680<br />driver_race: white","quarter: 15634.58<br />search_rate_100: 0.18755465<br />driver_race: white","quarter: 15656.53<br />search_rate_100: 0.17640932<br />driver_race: white","quarter: 15678.48<br />search_rate_100: 0.16502280<br />driver_race: white","quarter: 15700.43<br />search_rate_100: 0.15409709<br />driver_race: white","quarter: 15722.38<br />search_rate_100: 0.14433419<br />driver_race: white","quarter: 15744.33<br />search_rate_100: 0.13643609<br />driver_race: white","quarter: 15766.28<br />search_rate_100: 0.13036449<br />driver_race: white","quarter: 15788.23<br />search_rate_100: 0.12435686<br />driver_race: white","quarter: 15810.18<br />search_rate_100: 0.11837802<br />driver_race: white","quarter: 15832.13<br />search_rate_100: 0.11252462<br />driver_race: white","quarter: 15854.08<br />search_rate_100: 0.10689329<br />driver_race: white","quarter: 15876.03<br />search_rate_100: 0.10158069<br />driver_race: white","quarter: 15897.97<br />search_rate_100: 0.09668344<br />driver_race: white","quarter: 15919.92<br />search_rate_100: 0.09229819<br />driver_race: white","quarter: 15941.87<br />search_rate_100: 0.08859604<br />driver_race: white","quarter: 15963.82<br />search_rate_100: 0.08609319<br />driver_race: white","quarter: 15985.77<br />search_rate_100: 0.08464379<br />driver_race: white","quarter: 16007.72<br />search_rate_100: 0.08397177<br />driver_race: white","quarter: 16029.67<br />search_rate_100: 0.08380109<br />driver_race: white","quarter: 16051.62<br />search_rate_100: 0.08385571<br />driver_race: white","quarter: 16073.57<br />search_rate_100: 0.08385957<br />driver_race: white","quarter: 16095.52<br />search_rate_100: 0.08353663<br />driver_race: white","quarter: 16117.47<br />search_rate_100: 0.08261303<br />driver_race: white","quarter: 16139.42<br />search_rate_100: 0.08141200<br />driver_race: white","quarter: 16161.37<br />search_rate_100: 0.08028758<br />driver_race: white","quarter: 16183.32<br />search_rate_100: 0.07919852<br />driver_race: white","quarter: 16205.27<br />search_rate_100: 0.07810358<br />driver_race: white","quarter: 16227.22<br />search_rate_100: 0.07699788<br />driver_race: white","quarter: 16249.16<br />search_rate_100: 0.07590796<br />driver_race: white","quarter: 16271.11<br />search_rate_100: 0.07484171<br />driver_race: white","quarter: 16293.06<br />search_rate_100: 0.07380702<br />driver_race: white","quarter: 16315.01<br />search_rate_100: 0.07281175<br />driver_race: white","quarter: 16336.96<br />search_rate_100: 0.07186378<br />driver_race: white","quarter: 16358.91<br />search_rate_100: 0.07097100<br />driver_race: white","quarter: 16380.86<br />search_rate_100: 0.07014129<br />driver_race: white","quarter: 16402.81<br />search_rate_100: 0.06937258<br />driver_race: white","quarter: 16424.76<br />search_rate_100: 0.06863499<br />driver_race: white","quarter: 16446.71<br />search_rate_100: 0.06793083<br />driver_race: white","quarter: 16468.66<br />search_rate_100: 0.06726584<br />driver_race: white","quarter: 16490.61<br />search_rate_100: 0.06664575<br />driver_race: white","quarter: 16512.56<br />search_rate_100: 0.06607629<br />driver_race: white","quarter: 16534.51<br />search_rate_100: 0.06556318<br />driver_race: white","quarter: 16556.46<br />search_rate_100: 0.06511216<br />driver_race: white","quarter: 16578.41<br />search_rate_100: 0.06472815<br />driver_race: white","quarter: 16600.35<br />search_rate_100: 0.06440653<br />driver_race: white","quarter: 16622.30<br />search_rate_100: 0.06414403<br />driver_race: white","quarter: 16644.25<br />search_rate_100: 0.06393902<br />driver_race: white","quarter: 16666.20<br />search_rate_100: 0.06378984<br />driver_race: white","quarter: 16688.15<br />search_rate_100: 0.06369485<br />driver_race: white","quarter: 16710.10<br />search_rate_100: 0.06365239<br />driver_race: white","quarter: 16732.05<br />search_rate_100: 0.06366083<br />driver_race: white","quarter: 16754.00<br />search_rate_100: 0.06371852<br />driver_race: white"],"type":"scatter","mode":"lines","name":"white","line":{"width":3.77952755905512,"color":"rgba(97,156,255,1)","dash":"solid"},"hoveron":"points","legendgroup":"white","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[15020,15109,15201,15293,15385,15475,15567,15751,15840,15932,16024,16116,16205,16297,16389,16481,16570,16662,16754],"y":[0.459837589276979,0.413507925568573,0.351837372947615,0.554219387221583,0.471253534401508,0.514486867045762,0.391097867585436,0.145878920495988,0.169236555095901,0.106951871657754,0.194462450226873,0.0848896434634975,0.157640949554896,0.0520508015823444,0.143184421534937,0.161174785100287,0.140002545500827,0.0964692263168049,0.0716552359504555],"text":["quarter: 2011-02-15<br />search_rate_100: 0.45983759<br />driver_race: black","quarter: 2011-05-15<br />search_rate_100: 0.41350793<br />driver_race: black","quarter: 2011-08-15<br />search_rate_100: 0.35183737<br />driver_race: black","quarter: 2011-11-15<br />search_rate_100: 0.55421939<br />driver_race: black","quarter: 2012-02-15<br />search_rate_100: 0.47125353<br />driver_race: black","quarter: 2012-05-15<br />search_rate_100: 0.51448687<br />driver_race: black","quarter: 2012-08-15<br />search_rate_100: 0.39109787<br />driver_race: black","quarter: 2013-02-15<br />search_rate_100: 0.14587892<br />driver_race: black","quarter: 2013-05-15<br />search_rate_100: 0.16923656<br />driver_race: black","quarter: 2013-08-15<br />search_rate_100: 0.10695187<br />driver_race: black","quarter: 2013-11-15<br />search_rate_100: 0.19446245<br />driver_race: black","quarter: 2014-02-15<br />search_rate_100: 0.08488964<br />driver_race: black","quarter: 2014-05-15<br />search_rate_100: 0.15764095<br />driver_race: black","quarter: 2014-08-15<br />search_rate_100: 0.05205080<br />driver_race: black","quarter: 2014-11-15<br />search_rate_100: 0.14318442<br />driver_race: black","quarter: 2015-02-15<br />search_rate_100: 0.16117479<br />driver_race: black","quarter: 2015-05-15<br />search_rate_100: 0.14000255<br />driver_race: black","quarter: 2015-08-15<br />search_rate_100: 0.09646923<br />driver_race: black","quarter: 2015-11-15<br />search_rate_100: 0.07165524<br />driver_race: black"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)"}},"hoveron":"points","name":"black","legendgroup":"black","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[15020,15109,15201,15293,15385,15475,15567,15751,15840,15932,16024,16116,16205,16297,16389,16481,16570,16662,16754],"y":[0.310350178451353,0.378442458508116,0.36142286475176,0.485411825458301,0.439640012413365,0.372421695951108,0.438100621820237,0.266948957518295,0.154023873700424,0.236735830664253,0.154120310167124,0.156870434825237,0.174504452100765,0.0966837474620516,0.15165958921917,0.119622524478313,0.0986067816018831,0.0889638057779651,0.141102691403188],"text":["quarter: 2011-02-15<br />search_rate_100: 0.31035018<br />driver_race: hispanic","quarter: 2011-05-15<br />search_rate_100: 0.37844246<br />driver_race: hispanic","quarter: 2011-08-15<br />search_rate_100: 0.36142286<br />driver_race: hispanic","quarter: 2011-11-15<br />search_rate_100: 0.48541183<br />driver_race: hispanic","quarter: 2012-02-15<br />search_rate_100: 0.43964001<br />driver_race: hispanic","quarter: 2012-05-15<br />search_rate_100: 0.37242170<br />driver_race: hispanic","quarter: 2012-08-15<br />search_rate_100: 0.43810062<br />driver_race: hispanic","quarter: 2013-02-15<br />search_rate_100: 0.26694896<br />driver_race: hispanic","quarter: 2013-05-15<br />search_rate_100: 0.15402387<br />driver_race: hispanic","quarter: 2013-08-15<br />search_rate_100: 0.23673583<br />driver_race: hispanic","quarter: 2013-11-15<br />search_rate_100: 0.15412031<br />driver_race: hispanic","quarter: 2014-02-15<br />search_rate_100: 0.15687043<br />driver_race: hispanic","quarter: 2014-05-15<br />search_rate_100: 0.17450445<br />driver_race: hispanic","quarter: 2014-08-15<br />search_rate_100: 0.09668375<br />driver_race: hispanic","quarter: 2014-11-15<br />search_rate_100: 0.15165959<br />driver_race: hispanic","quarter: 2015-02-15<br />search_rate_100: 0.11962252<br />driver_race: hispanic","quarter: 2015-05-15<br />search_rate_100: 0.09860678<br />driver_race: hispanic","quarter: 2015-08-15<br />search_rate_100: 0.08896381<br />driver_race: hispanic","quarter: 2015-11-15<br />search_rate_100: 0.14110269<br />driver_race: hispanic"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,186,56,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,186,56,1)"}},"hoveron":"points","name":"hispanic","legendgroup":"hispanic","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[15020,15109,15201,15293,15385,15475,15567,15751,15840,15932,16024,16116,16205,16297,16389,16481,16570,16662,16754],"y":[0.205363113943978,0.228282073631345,0.197987311310435,0.269519327451109,0.278943501488114,0.263360982638683,0.240478321263664,0.0951043630525144,0.0872730750608222,0.0986871089963873,0.0811415951339446,0.109572850556175,0.0807668095922464,0.0598028435287536,0.0587072055370164,0.0722173742966329,0.0751212801390196,0.0451774688831999,0.0737289135307302],"text":["quarter: 2011-02-15<br />search_rate_100: 0.20536311<br />driver_race: white","quarter: 2011-05-15<br />search_rate_100: 0.22828207<br />driver_race: white","quarter: 2011-08-15<br />search_rate_100: 0.19798731<br />driver_race: white","quarter: 2011-11-15<br />search_rate_100: 0.26951933<br />driver_race: white","quarter: 2012-02-15<br />search_rate_100: 0.27894350<br />driver_race: white","quarter: 2012-05-15<br />search_rate_100: 0.26336098<br />driver_race: white","quarter: 2012-08-15<br />search_rate_100: 0.24047832<br />driver_race: white","quarter: 2013-02-15<br />search_rate_100: 0.09510436<br />driver_race: white","quarter: 2013-05-15<br />search_rate_100: 0.08727308<br />driver_race: white","quarter: 2013-08-15<br />search_rate_100: 0.09868711<br />driver_race: white","quarter: 2013-11-15<br />search_rate_100: 0.08114160<br />driver_race: white","quarter: 2014-02-15<br />search_rate_100: 0.10957285<br />driver_race: white","quarter: 2014-05-15<br />search_rate_100: 0.08076681<br />driver_race: white","quarter: 2014-08-15<br />search_rate_100: 0.05980284<br />driver_race: white","quarter: 2014-11-15<br />search_rate_100: 0.05870721<br />driver_race: white","quarter: 2015-02-15<br />search_rate_100: 0.07221737<br />driver_race: white","quarter: 2015-05-15<br />search_rate_100: 0.07512128<br />driver_race: white","quarter: 2015-08-15<br />search_rate_100: 0.04517747<br />driver_race: white","quarter: 2015-11-15<br />search_rate_100: 0.07372891<br />driver_race: white"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(97,156,255,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(97,156,255,1)"}},"hoveron":"points","name":"white","legendgroup":"white","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":45.7108066971081,"r":7.30593607305936,"b":42.130898021309,"l":43.1050228310502},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"title":{"text":"Washington","font":{"color":"rgba(0,0,0,1)","family":"","size":17.5342465753425},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[14933.3,16840.7],"tickmode":"array","ticktext":["2012","2014","2016"],"tickvals":[15340,16071,16801],"categoryorder":"array","categoryarray":["2012","2014","2016"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"quarter","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.0197253729662807,0.579671483138502],"tickmode":"array","ticktext":["0.1","0.2","0.3","0.4","0.5"],"tickvals":[0.1,0.2,0.3,0.4,0.5],"categoryorder":"array","categoryarray":["0.1","0.2","0.3","0.4","0.5"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"search_rate_100","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"y":0.855643044619423},"annotations":[{"text":"driver_race","x":1.02,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"left","yanchor":"bottom","legendTitle":true}],"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"fc3645c138d":{"x":{},"y":{},"colour":{},"type":"scatter"},"fc35907c174":{"x":{},"y":{},"colour":{}}},"cur_data":"fc3645c138d","visdat":{"fc3645c138d":["function (y) ","x"],"fc35907c174":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>




---

## Your turn!

---
.pull-left[
**Final Exercise:** [Recreate this chart](https://www.nbcnews.com/news/us-news/police-searches-drop-dramatically-states-legalized-marijuana-n776146)

&lt;img src="./img/cnbc.png" width="75%" height="85%" /&gt;
]

.pull-right[

#### Some code to get you started:


```r
stops %&gt;% filter(state == "WA") %&gt;% 
  ggplot(aes(quarter, search_rate_100, color = driver_race)) +
  geom_point() +
  geom_smooth(method = lm, se = FALSE) 
```

- '?labs' layer controls title, subtitle, caption, etc.

- '?scale_color_manual' layer allows you to specify your own colors for the levels

- '?geom_vline' layer draws a vertical line across the plot. (hint: the x-axis is a date data type)

- '?theme' controls the non-data elements of the plot like size of text, angle of axis ticks, etc.

- '?annotate' creates a text annotation layer. Same trick with coordinates as geom_vline

- Experiment with [themes](https://ggplot2.tidyverse.org/reference/ggtheme.html)

]


---




## Keep practicing

[Tidy Tuesday](https://github.com/rfordatascience/tidytuesday)

&lt;img src="./img/tidytuesday.png" width="75%" /&gt;

---

## Get help

[SSDS Consulting](https://ssds.stanford.edu/consulting-workshops/walk-consulting)

&lt;img src="./img/cidr.png" width="50%" /&gt;


---

## Themes Vignette

To really master themes:

[ggplot2.tidyverse.org/articles/extending-ggplot2.html#creating-your-own-theme](https://ggplot2.tidyverse.org/articles/extending-ggplot2.html#creating-your-own-theme)

---

class: center, middle

# Recap

---

## The basics

* map variables to aethestics
* add "geoms" for visual representation layers
* scales can be independently managed
* legends are automatically created
* statistics are sometimes calculated by geoms

---

## ggplot2 template

Make any plot by filling in the parameters of this template

&lt;img src="./img/ggplot2-template.png" width="100%" /&gt;


---

## Learn more

* Books: 
  - [ggplot2 documentation](https://ggplot2.tidyverse.org/reference/)
  - [R for Data Science](https://r4ds.had.co.nz) by Grolemund and Wickham
  - [R Graphics Cookbook](http://www.cookbook-r.com/Graphs/) by Chang
  - [Data Visualization: A Practical Introduction](https://kieranhealy.org/publications/dataviz/) by Healy
* [ggplot2.tidyverse.org](https://ggplot2.tidyverse.org/)
* [ggplot2 Cheat sheet](https://rstudio.com/resources/cheatsheets/)


---

## Thanks

    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "solarized-light",
"highlightLines": true,
"countIncrementalSlides": false,
"ratio": "16:9"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
